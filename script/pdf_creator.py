

Aller au contenu
Utiliser Gmail avec un lecteur d'√©cran

Recherche

Rechercher dans les messages

Boomerang
Nouveau message

Pause Inbox
Libell√©s
Bo√Æte de r√©ception
Messages suivis
En attente
Important
Messages envoy√©s
Brouillons
2
Cat√©gories
[Imap]/Trash
Adminisatration
Appartement
Bourse
Cours
FAC
Gematique
Important mp
Loisir
stage
Plus
 
R√©duireHangouts

 
 
 
 
Plus
1‚Äì35 sur 35


Conversations

Principale
R√©seaux sociaux
3 nouveaux
Promotions
Wish, Ark√©a Arena, GitHub
Magdaleine Soury
Script pdf_creator final
 - Je l'ai mis en .txt sinon il passe pas en mail. T'as juste √† le repasser en .py
Pi√®ce jointe :
pdf_creator.txt
12:13
Christelle Ballut
Retour des apprentis du MASTER MIAGE en entreprise
 - Message √† l'attention des services RH et ma√Ætres d'apprentissage Copie aux apprentis (merci de relayer aupr√®s de vos entreprises √©galement) Bonjour, Comme l'indique le calendrier de l'
Pi√®ce jointe :
QR-coronavirus-apprentissage-06042020.pdf
Pi√®ce jointe :
calendrier MIAGE.xlsx
09:43
moi, Magdaleine
2
num etudiant
 - De : Melanie Fonseca <melanie93fonseca@gmail.com> Envoy√© : mardi 14 avril 2020 23:47 √Ä : Magdaleine Soury <soury.magdaleine@outlook.fr> Objet : num etudiant Garanti sans virus. www.avast.
Pi√®ce jointe :
simple shape detection.py
Pi√®ce jointe :
sujet (1)_004.jpg
Pi√®ce jointe :
simple shape detection.py
00:00
Magdaleine Soury
Fichier sujet3
 
14 avr.
Magdaleine Soury
Fichier sujet2
 
14 avr.
Magdaleine Soury
Fichier sujet
 
Pi√®ce jointe :
modif.pdf
14 avr.
Yamina MOUHOUN
plan site
 - coucou mel, je te l'ai mis dans un fichier texte, copie colle directe . bisous bisous
Pi√®ce jointe :
plansitemaj.txt
14 avr.
Carole Bobin
VOTRE SITUATION
 - Bonjour les situations des uns et des autres sont amen√©es √† changer (ou pas) j'esp√®re que cela ne vous p√®se pas trop......... si vous rencontrez des probl√®mes,
 
14 avr.
Magdaleine Soury
Fichier modifi√©
 - Je viens de modifier ce fichier, il y avait un bug avec l‚Äôenregistrement en base. Je t‚Äôenvoi aussi un sujet.txt qui fonctionne.
Pi√®ce jointe :
EnregistreSujet.php
Pi√®ce jointe :
sujet.txt
14 avr.
Magdaleine Soury
Fast Eval - fichiers modifi√©s
 - Voila tous les fichiers que j‚Äôai modifi√©. Je m‚Äôoccupe des scripts de la BDD demain matin.
14 avr.
Magdaleine Soury
R√©cup√©ration fichiers
 
Pi√®ce jointe :
EnregistreSujet.php
Pi√®ce jointe :
sujets.php
13 avr.
moi
Exo stats
 
Pi√®ce jointe :
IMG_0183.jpg
Pi√®ce jointe :
IMG_0179.jpg
Pi√®ce jointe :
IMG_0184.jpg
et 3 autre(s)
8 avr.
DESSAGNES H√©l√®ne
g√©matique / salaires mars
 - Bonjour M√©lanie Tu trouveras en pj ton bulletin de mars. La convention collective pr√©voit une indemnisation suppl√©mentaire en plus de celle l√©gale, d'o√π la lign
Pi√®ce jointe :
image-f1519.png
Pi√®ce jointe :
Payes mars.pdf
31 mars
Yamina MOUHOUN
d√©tecter le num√©ro d'√©tudiant
 - Coucou M√©lanie, Je te joins en pi√®ce jointe le script reconnaissant le numero etudiant. Je t avoue que j'ai eu beaucoup de mal avec mon modeste niveau de progra
Pi√®ce jointe :
livraison.zip
31 mars
ATTIVI IMMOBILIER
Avis d'√©ch√©ance / quittance 01/04/2020 - 30/04/2020
 - Bonjour Mlle FONSECA NASCIMENTO M√©lanie, Veuillez trouver, ci joint votre avis d'√©ch√©ance et votre quittance. Bien cordialement Le service gestion SARL ATTIVI I
Pi√®ce jointe :
Quittance 2020-03-01.pdf
26 mars
Carole Bobin
ACCOMPAGNEMENT
 - Bonjour Avant tout nous esp√©rons que vous allez bien en d√©pit de cette p√©riode difficile. L‚ÄôUA ST, souhaite continuer √† vous accompagner. Nous avons eu de votre
 
23 mars
√âquipe des comptes .
R√©initialisation du mot de passe du compte Microsoft
 - Compte Microsoft Code de r√©initialisation de mot de passe Utilisez ce code pour r√©initialiser le mot de passe du compte Microsoft me*****@gmail.com. Voici votre
 
22 mars
La Team BattleDev
On maintient la BattleDev
 - Et on aide la recherche avec l'Institut Pasteur Bonjour √† tous, La BattleDev du Jeudi 26/03 prochain est bien maintenue - Un √©v√©nement 100% en ligne - On rompt
 
20 mars
Christelle Ballut
IMPORTANT : date de reprise des cours pour les MASTER 1 MIAGE
 - Bonjour √† tous, Voici l'e-mail qui vient d'√™tre envoy√© √† votre entreprise : L'√©quipe de formation du MASTER MIAGE vient de nous contacter pour nous informer de
 
20 mars
moi
2
cous debut lundi
 - Garanti sans virus. www.avast.com Le ven. 20 mars 2020 √† 14:22, Melanie Fonseca <melanie93fonseca@gmail.com> a √©crit : Un petit message afin de vous pr√©venir qu
Pi√®ce jointe :
Mail responsable_M1_MIAGE.png
Pi√®ce jointe :
mail_CFA.png
20 mars
La Team BattleDev
On maintien la BattleDev
 - Et on aide la recherche avec l'Institut Pasteur Logo BattleDev Bonjour √† tous, La BattleDev du Jeudi 26/03 prochain est bien maintenue üòä Un √©v√©nement 100% en ligne On rompt avec l'isolement,
 
20 mars
Christelle Ballut
Message de la part de la Direction du CFA CENTRAL de l'universit√© de Bordeaux
 - Bonjour √† tous, La Direction du CFA Central nous demande de transmettre cette information aux ma√Ætres d'apprentissage ainsi qu'aux apprentis. ---------------------------------------------------
 
19 mars
David Reungoat
[info COVID19]
 - Cher(e) Apprenti(e) Suite aux annonces de notre pr√©sident, pr√©sident d'Universit√© et des directeurs de coll√®ge et institut sachez que le CFA et ses √©quipes : UA Sant√©, UA ST, UA IUT, UA ISVV, UA SH
 
14 mars
La Team BattleDev
M√©lanie tu veux gagner un Raspberry PI ? üèÜ
 - Pour jouer c'est tr√®s simple et rapide. Logo BattleDev Hello M√©lanie, Si tu gagnais un Raspberry PI, tu ferais quoi avec ? Bonne question hein ? On te la pose car en attendant la BattleDev, on
 
14 mars
Christelle Ballut
URGENT et IMPORTANT : votre situation en tant qu'apprentis d√®s le lundi 16 mars
 - Bonjour √† tous, Suite aux d√©cisions prises par la Ministre du travail, relay√©es par le D√©l√©gu√© G√©n√©ral √† l'emploi et √† la Formation Professionnelle : - Les CFA doivent √™tre ferm√©s √† partir du lundi
 
13 mars
nolath phothirath
2
Point stage alternance M√©lanie Nascimento
 - Bonjour, Pouvez-vous proposer 2 cr√©neaux sauf mardi 17/03 ? Je m'adapterai. Bien Cordialement, Nolath Phothirath 06 48 55 35 08 Le jeu. 12 mars 2020 √† 09:52, St√©phane PEDELOUP <spedeloup@
Pi√®ce jointe :
image-6fe55.png
12 mars
Esp@ce Client Bouyg.
3
Votre facture Bouygues Telecom est disponible
 - Voici les informations concernant votre nouvelle facture. Bonjour MME GARCIA FONSECA NASCIMENTO IRENE DA CONCEICAO Votre num√©ro de client : 1.43365530 Ligne : 0634312645 Votre nouvelle facture d'un
 
11 mars
Magdaleine Soury
2
FastEval - Sujet de QCM
 - Voici le num √©tudiant / anonymat De : Magdaleine Soury Envoy√© : lundi 9 mars 2020 19:46 √Ä : Melanie Fonseca <melanie93fonseca@gmail.com> Objet : FastEval - Sujet de QCM Je t'envoie un sujet
Pi√®ce jointe :
sujet.pdf
Pi√®ce jointe :
sujet.pdf
9 mars
La Team BattleDev
Communiqu√© de Presse - BattleDev
 - Alerte Coronavirus - √âv√®nement maintenu ! Logo BattleDev Hello √† tous, Nous allons bient√¥t atteindre les 5000 inscrits √† la BattleDev ! Rassurez-vous, la BattleDev, comp√©tition en ligne aura bien lieu
 
9 mars
Bouygues Telecom
Mme Garcia Fonseca Nascimento, voici la solution pour connecter tous vos appareils √† internet !
 - Inclus dans votre offre, une 2e carte SIM pour connecter en 4G tous vos appareils Retrouvez cet e-mail √©galement sur la version en ligne. Bouygues Telecom Irene Da Conceicao GARCIA FONSECA NASCIMENTO
 
9 mars
La Team BattleDev
Rien ne vaut un bon entrainement
 - Pr√™t pour la comp√©tition ? Un voyage √† Vegas √† gagner Logo BattleDev Hello M√©lanie, Tu es inscrit √† la BattleDev c'est bien, mais es-tu vraiment pr√™t ? Veux-tu te pr√©parer pour la BattleDev ? Nous
 
7 mars
La Team BattleDev
Bienvenue dans l'ar√®ne M√©lanie
 - Pr√™t pour la comp√©tition ? Logo BattleDev Quel courage M√©lanie ! Tu as d√©sormais ta place dans la BattleDev. On esp√®re que tu as les nerfs solides car il n'y aura qu'un seul champion. üèÜ
 
6 mars
La Team BattleDev
, seras-tu l'√©lu ? üéÅ
 - Des surprises t'attendent Logo BattleDev Hello , Parce qu'on est sympa et qu'on aime bien vous offrir des cadeaux, une surprise sera offerte √† tous les paliers de 1000 inscriptions atteints
 
5 mars
ATTIVI IMMOBILIER
IMPORTANT - DEMANDE ACCES AU LOGEMENT
 - SARL ATTIVI IMMOBILIER 142 Cours du G√©n√©ral de Gaulle 33170 Gradignan Contacts : 0557120028 attivi.immobilier@ladresse.com Siret : 80359057900022, SARL au capital de 5 000,00 ‚Ç¨ Carte pro. : CPI 3301
Pi√®ce jointe :
LANCELOT-CONVOCATION.pdf
5 mars
La Team BattleDev
, +5000 devs √† affronter, √ßa te chauffe ? üëä
 - Pr√™t pour la comp√©tition ? Un PC portable ZenBook Pro Duo √† gagner ! Logo BattleDev 2h, 5000 devs et beaucoup de sang froid‚Ä¶ √áa te rappelle des souvenirs ? Oui, on parle bien de ta participation √† la
 
22 f√©vr.
2,43 Go (16 %) utilis√©s sur 15 Go
G√©rer
Conditions d'utilisation ¬∑ Confidentialit√© ¬∑ R√®glement du programme
Derni√®re activit√© sur le compte : il y a 36 minutes
D√©tails

from reportlab.pdfgen import canvas
from reportlab.lib import utils
from reportlab.lib.colors import black, white
from reportlab.lib.utils import simpleSplit
from textwrap import wrap
import random
import os.path


def retournerTitre(cheminFichier) :
    titre = "Evaluation"
    with open(cheminFichier, encoding='utf-8', mode="r") as fichier:
        texte = fichier.read()
        indice = texte.find("Title:")
        indice2 = texte.find("\n", indice)
        if indice != -1 :
            titre = texte[indice+6:indice2].strip()
    return titre


def retournerPresentation(cheminFichier) :
    presentation = ""
    with open(cheminFichier, encoding='utf-8', mode="r") as fichier:
        texte = fichier.read()
        indice = texte.find("Presentation:")
        indice2 = texte.find("\n", indice)
        if indice != -1 :
            presentation = texte[indice+13:indice2].strip()
    return presentation


def retournerColonnes(cheminFichier) :
    colonnes = 1
    with open(cheminFichier, encoding='utf-8', mode="r") as fichier:
        texte = fichier.read()
        indice = texte.find("Columns:")
        indice2 = texte.find("\n", indice)
        if indice != -1 :
            texteColonnes = texte[indice+8:indice2].strip()
            texteColonnes = int(texteColonnes)
            if texteColonnes > 1 :
                colonnes = 2 # bloqu√© √† 2 pour ne pas avoir de probl√®me d'affichage trop condens√©
    return colonnes


def retournerQuestions(cheminFichier) :
    questions = []
    
    with open(cheminFichier, encoding='utf-8', mode="r") as fichier:
        texte = fichier.read()
        fichierFini = False
        while fichierFini == False:
            indice = texte.find("*", 3)
            if indice == -1 :
                question = texte
                fichierFini = True
            else :
                question = texte[:indice]
                texte = texte[indice:]
            
            indice = question.find("*")
            
            if indice == 0:
                questions.append(question)
        
    return questions


def retournerIntituleQuestion(question) :
    debutVerbatim = question.find("[verbatim]")
    debutImage = question.find("![height")
    
    if debutVerbatim != -1 or debutImage != -1 :
        if debutVerbatim != -1 and debutImage != -1 :
            debutVerbatim = min(debutVerbatim, debutImage)
        elif debutImage != -1 :
            debutVerbatim = debutImage
        indiceDebut = max(question[0:debutVerbatim].find("}"), question[0:debutVerbatim].find("]"), 0)+1
        indiceFin = debutVerbatim
    else :
        indiceDebut = max(question.find("}"), question.find("]"), 0)+1
        indiceFin = min(question.find("+ ", indiceDebut), question.find("- ", indiceDebut))
    
    if question[0] == "*" :
        indiceDebut = indiceDebut+1
    intitule = " ".join(question[indiceDebut:indiceFin].split())
    
    return intitule


def retournerVerbatimQuestion(question) :
    verbatim = ""
    debutVerbatim = question.find("[verbatim]")
    finVerbatim = question.find("[/verbatim]")

    if debutVerbatim != -1 :
        verbatim = question[debutVerbatim+10:finVerbatim].strip()
    
    return verbatim


def retournerUrlImageQuestion(question) :
    urlImage = ""
    debut = question.find("![height")
    debutImage = question.find("]", debut)
    finImage = question.find("!", debutImage)

    if debutImage != -1 :
        urlImage = question[debutImage+1:finImage].strip()
        urlImage = os.getcwd().replace("\\","/")+"/"+urlImage
    
    return urlImage


def retournerTailleImageQuestion(question) :
    tailleImage = ""
    debutImage = question.find("![height=")
    finImage = question.find("cm", debutImage)
    
    if debutImage != -1 :
        tailleImage = int(question[debutImage+9:finImage].strip())
    
    return tailleImage


def retournerColonnesQuestion(question) :
    colonnes = 1
    debut = question.find("columns")
    debut = question.find("=", debut)
    fin = min(question.find("]", debut), question.find(",", debut))
    if debut != -1 :
        texteColonnes = question[debut+1:fin].strip()
        texteColonnes = int(texteColonnes)
        if texteColonnes > 4 :
            colonnes = 4 # bloqu√© √† 4 pour ne pas avoir de probl√®me d'affichage trop condens√©
    
    return colonnes


def retournerHorizQuestion(question) :
    horiz = False
    debut = question.find("horiz")
    if debut != -1 :
        horiz = True
    
    return horiz


def retournerReponsesQuestion(question) :
    indiceDebutReponses = min(question.find("+ "), question.find("- "))
    reponses = question[indiceDebutReponses:].split("\n")
    listeReponses = []
    
    indiceDebut = 0

    for i in range(len(reponses)):
        if reponses[i] != "" :
            reponse = (reponses[i][1:]).strip()
            listeReponses.append(reponse)
        
    return listeReponses


def getNbRepMax(questions) :
    nb = 0
    for i in range(len(questions)):
        reponses = retournerReponsesQuestion(questions[i])
        if len(reponses) > nb :
            nb = len(reponses)
    
    return nb
    

def retournerCode(cheminFichier) :
    code = 8
    with open(cheminFichier, encoding='utf-8', mode="r") as fichier:
        texte = fichier.read()
        indice = texte.find("Code:")
        indice2 = texte.find("\n", indice)
        if indice != -1 :
            code = int(texte[indice+5:indice2].strip())
            if code > 10 :
                code = 10
    return code


###########################################################

liste = ["a","b","c","d","e","f", "g", "h", "i", "j", "k"]

## Saisie des param√®tres ##################################

fichierQuestions = sys.argv[1]
nouveauFichier = sys.argv[2]
if sys.argv[3] == "false":
    anonymat = False
else:
    anonymat = True
numSujet = sys.argv[4]



###########################################################

canvas = canvas.Canvas(nouveauFichier)
titre = retournerTitre(fichierQuestions)

presentation = retournerPresentation(fichierQuestions)
colonnes = retournerColonnes(fichierQuestions)

## creation d'une liste contenant toutes les questions
questions = retournerQuestions(fichierQuestions)

## Feuilles des questions ######
canvas.setFont('Helvetica-Bold', 12)
canvas.drawCentredString(300, 710, titre)

canvas.setFont('Helvetica', 12)

canvas.drawString(500, 770, "Sujet "+numSujet)

## Etudiant nominatif
if anonymat == False :
    canvas.drawString(50, 750, "Nom : ____________")
    canvas.drawString(50, 730, "Pr√©nom : ____________")
## Etudiant anonyme
else : 
    canvas.drawString(50, 750, "Num√©ro d'anonymat : ____________")

## Consignes
if presentation != "" :
    canvas.drawString(50, 680, presentation)

textObject=canvas.beginText(50,640)

indiceColonne = 1


## Parcours des questions une √† une
for i in range(len(questions)) :
    
    nbLignes = 0

    ## Gestion du changement de colonne et/ou de page
    if textObject.getY() < 250 :
        if colonnes == 2 :
            indiceColonne = indiceColonne + 1
            if indiceColonne == 2 :
                canvas.drawText(textObject)
                textObject=canvas.beginText(320,640)
            else :
                indiceColonne = 1
                canvas.drawText(textObject)
                textObject=canvas.beginText(50,640)
        else :
            canvas.drawText(textObject)

            canvas.drawCentredString(300, 50, str(canvas.getPageNumber()))
            
            canvas.showPage()
            canvas.setFont('Helvetica', 12)
            canvas.drawString(500, 770, "Sujet "+numSujet)
            nbLignes = 0
            textObject=canvas.beginText(50,680)
            if anonymat == False :
                canvas.drawString(50, 750, "Nom : ____________")
                canvas.drawString(50, 730, "Pr√©nom : ____________")
            else : 
                canvas.drawString(50, 750, "Num√©ro d'anonymat : ____________")
    
    intitule = ""+str(i+1)+". "+retournerIntituleQuestion(questions[i])
    
    if colonnes == 2 :
        intitule = "\n".join(wrap(intitule, 45))
    else :
        intitule = "\n".join(wrap(intitule, 90))
    
    textObject.textLines(intitule)

    nbLignes = nbLignes + len(simpleSplit(intitule, 'Helvetica', 12, 500))
    
    verbatim = retournerVerbatimQuestion(questions[i])
    if verbatim != "":
        intitule = verbatim
        textObject.setFont('Helvetica-Oblique', 12)
        textObject.textLines(intitule)
        textObject.setFont('Helvetica', 12)
    
    urlImage = retournerUrlImageQuestion(questions[i])
    if urlImage != "" :
        tailleImage = retournerTailleImageQuestion(questions[i])    
        img = utils.ImageReader(urlImage)
        w, h = img.getSize()
        ratio = w / float(h)
        hauteurImage = tailleImage*35
        largeurImage = hauteurImage*ratio
        
        textObject.textLine(" ")
        
        canvas.drawImage(urlImage,textObject.getX(),textObject.getY()-(nbLignes*50),width=largeurImage,height=hauteurImage,mask='auto') 
        
        textObject.textLine(" ")
        textObject.textLine(" ")
        textObject.textLine(" ")
        textObject.textLine(" ")
        textObject.textLine(" ")
        
    horizQuestion = retournerHorizQuestion(questions[i])
    columnsQuestion = retournerColonnesQuestion(questions[i])
    
    reponses = retournerReponsesQuestion(questions[i])
    
    decalage = 0
    indiceColonneReponse = 1

    ## Affichage des r√©ponses
    for j in range(len(reponses)) :
        x = textObject.getX()
        y = textObject.getY()
        textObject.moveCursor(15, 0)
        if colonnes == 2 :
            intitule = "\n".join(wrap(reponses[j], 45))
        else :
            intitule = "\n".join(wrap(reponses[j], 90))
        
        if horizQuestion == True :
            longueurIntitule = canvas.stringWidth(intitule, 'Helvetica', 12)
            textObject.textOut(liste[j]+" : "+intitule)
            textObject.moveCursor(longueurIntitule+30, 0)
            decalage = decalage + longueurIntitule+30
        else :
            textObject.textLines(liste[j]+" : "+intitule)

        nbLignes = nbLignes + len(simpleSplit(intitule, 'Helvetica', 12, 500))
        textObject.moveCursor(-15, 0)
    
    if decalage != 0 :
        textObject.moveCursor(-(decalage), 0)
        textObject.textLine("")
    
    textObject.textLine("")

canvas.drawCentredString(300, 50, str(canvas.getPageNumber()))
canvas.drawText(textObject)

## Feuilles des r√©ponses

canvas.showPage()
canvas.setFont('Helvetica', 12)
textObject=canvas.beginText(50,760)
textObject.setLeading(5)

canvas.setFont('Helvetica-Bold', 12)
canvas.drawCentredString(300, 770, "Feuille de r√©ponses")
canvas.setFont('Helvetica', 12)
canvas.drawString(500, 770, "Sujet "+numSujet)

code = retournerCode(fichierQuestions)

## Gestion de la grille de remplissage du num√©ro √©tudiant / anonymat
debutY = 730
espaceY = 20
finX = 540
                
for i in range(code) :
    if i == code - 1 :
        debutX = finX-i*16
        
    canvas.rect(finX-7-i*16.1, debutY, 14, 18)
    canvas.circle(finX-i*16, debutY-espaceY*1, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*2, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*3, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*4, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*5, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*6, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*7, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*8, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*9, 6, stroke=1, fill=0)
    canvas.circle(finX-i*16, debutY-espaceY*10, 6, stroke=1, fill=0)

if anonymat == True :
    canvas.drawString(debutX-100, debutY+4, "N¬∞ anonymat :")
else :
    canvas.drawString(350, debutY-espaceY*12, "Nom : ____________")
    canvas.drawString(350, debutY-espaceY*13, "Pr√©nom : ____________")
    canvas.drawString(debutX-90, debutY+4, "N¬∞ √©tudiant :")

debutY = debutY - 5

canvas.drawString(debutX-22, debutY-espaceY*1, "0")
canvas.drawString(debutX-22, debutY-espaceY*2, "1")
canvas.drawString(debutX-22, debutY-espaceY*3, "2")
canvas.drawString(debutX-22, debutY-espaceY*4, "3")
canvas.drawString(debutX-22, debutY-espaceY*5, "4")
canvas.drawString(debutX-22, debutY-espaceY*6, "5")
canvas.drawString(debutX-22, debutY-espaceY*7, "6")
canvas.drawString(debutX-22, debutY-espaceY*8, "7")
canvas.drawString(debutX-22, debutY-espaceY*9, "8")
canvas.drawString(debutX-22, debutY-espaceY*10, "9")

if anonymat == False :
    canvas.rect(debutX-100, debutY-espaceY*11+6, code*16+100, 245)
else :
    canvas.rect(debutX-110, debutY-espaceY*11+6, code*16+110, 245)


## Gestion des r√©ponses

nombreReponsesMax = getNbRepMax(questions)
    
xi = 40
xj = 0
yi = 745
yj = 0

t=0

for i in range(len(questions)) :
    
    numQuestion = ""+str(i+1)+". "
    
    if textObject.getY() > 1200 :
        canvas.drawText(textObject)
        yj = 725-45*t+20
        canvas.rect(xi, yj, xj-xi, yi-yj+8)
        xj = 0
        yj = 0
        canvas.drawCentredString(300, 50, str(canvas.getPageNumber()))                
        canvas.showPage()
        canvas.setFont('Helvetica', 12)
        textObject=canvas.beginText(50,760)
        textObject.setLeading(5)
        canvas.setFont('Helvetica-Bold', 12)
        canvas.drawCentredString(300, 770, "Feuille de r√©ponses")
        canvas.setFont('Helvetica', 12)
        canvas.drawString(500, 770, "Sujet "+numSujet)
        
        
        ## Gestion de la grille de remplissage du num√©ro √©tudiant / anonymat
        debutY = 730
        espaceY = 20
        finX = 540
                
        for i in range(code) :
            if i == code - 1 :
                debutX = finX-i*16
        
            canvas.rect(finX-7-i*16.1, debutY, 14, 18)
            canvas.circle(finX-i*16, debutY-espaceY*1, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*2, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*3, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*4, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*5, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*6, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*7, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*8, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*9, 6, stroke=1, fill=0)
            canvas.circle(finX-i*16, debutY-espaceY*10, 6, stroke=1, fill=0)

        if anonymat == True :
            canvas.drawString(debutX-100, debutY+4, "N¬∞ anonymat :")
        else :
            canvas.drawString(350, debutY-espaceY*12, "Nom : ____________")
            canvas.drawString(350, debutY-espaceY*13, "Pr√©nom : ____________")
            canvas.drawString(debutX-90, debutY+4, "N¬∞ √©tudiant :")

        debutY = debutY - 5

        canvas.drawString(debutX-22, debutY-espaceY*1, "0")
        canvas.drawString(debutX-22, debutY-espaceY*2, "1")
        canvas.drawString(debutX-22, debutY-espaceY*3, "2")
        canvas.drawString(debutX-22, debutY-espaceY*4, "3")
        canvas.drawString(debutX-22, debutY-espaceY*5, "4")
        canvas.drawString(debutX-22, debutY-espaceY*6, "5")
        canvas.drawString(debutX-22, debutY-espaceY*7, "6")
        canvas.drawString(debutX-22, debutY-espaceY*8, "7")
        canvas.drawString(debutX-22, debutY-espaceY*9, "8")
        canvas.drawString(debutX-22, debutY-espaceY*10, "9")

        if anonymat == False :
            canvas.rect(debutX-100, debutY-espaceY*11+6, code*16+100, 245)
        else :
            canvas.rect(debutX-110, debutY-espaceY*11+6, code*16+110, 245)

        t = 0
    
    textObject.moveCursor(0, 40)
    textObject.textLines(numQuestion)
    
    reponses = retournerReponsesQuestion(questions[i])
    
    y = 725-45*t
    
    if i == len(questions)-1 :
        if 725-20-45*t > yj :
            yj = y-30
    
    for j in range(nombreReponsesMax) :
        if j < len(reponses) :
            
            if j == len(reponses)-1 :
                if 80+30+30*j > xj :
                    xj = 80+20+30*j
            
            textObject.moveCursor(30,0)
            x = textObject.getX()
            
            canvas.setFont('Helvetica', 10)
            canvas.drawString(x-3, y-3, liste[j])
                    
        canvas.setStrokeColor(black)
        canvas.circle(80+30*j, y, 9, stroke=1, fill=0)

    xj = 80+20+30*(nombreReponsesMax-1)
    textObject.moveCursor(-30*len(reponses), 0)
    t = t+1

canvas.rect(xi, yj, xj-xi, yi-yj+8)
canvas.drawCentredString(300, 50, str(canvas.getPageNumber()))
canvas.drawText(textObject)


canvas.save()
pdf_creator.txt
Ouvrir avec
Affichage de pdf_creator.txt en cours...